<?xml version = "1.0" encoding = "UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="daftarHotel">

    <!-- Meminta List Hotel -->
    <resultMap id="getListHotel" type="com.hotel.database.model.Hotel">
        <result property="name" column="name"/>
        <result property="kota" column="kota"/>
        <result property="kamar" column="kamar"/>
        <result property="terpakai" column="terpakai"/>
        <result property="tersedia" column="tersedia"/>
        <result property="harga" column="harga"/>
        <result property="imglink" column="url" />
    </resultMap>
    <select id="getAllHotelList" resultMap="getListHotel">
        SELECT * FROM listhotel;
    </select>

    <!-- Pencarian nama hotel di DB Hotel -->
    <resultMap id="getHotelByName" type="com.hotel.database.model.Hotel">
        <result property="name" column="name"/>
    </resultMap>
    <select id="searchHotelName" resultMap="getHotelByName">
        SELECT * FROM listhotel WHERE name=#{name}
    </select>

    <!-- Pencarian username di DB USer -->
    <resultMap id="getUsernameFromUserDB" type="com.hotel.database.model.User">
        <result property="username" column="username" />
    </resultMap>
    <select id="searchUsernameFromUserDB" resultMap="getUsernameFromUserDB">
        SELECT * FROM user WHERE username=#{username};
    </select>

    <!-- Pencarian name di DB User -->
    <resultMap id="getNameFromUserDB" type="com.hotel.database.model.User">
        <result property="name" column="name" />
    </resultMap>
    <select id="searchNameFromUserDB" resultMap="getNameFromUserDB">
        SELECT * FROM user WHERE name=#{name};
    </select>

    <!-- Melakukan Input User Baru -->
    <insert id="insertUser" parameterType="com.hotel.database.model.User">
        INSERT INTO user (name, phone, address, username, email, password, avatar, status) VALUE (#{name}, #{phone}, #{address}, #{username}, #{email}, #{password}, #{avatar}, #{status});
    </insert>

    <!-- Melakukan Input Pesanan ke DB Pesanan -->
    <insert id="insertOrder" parameterType="com.hotel.database.model.OrderHotel">
        INSERT INTO pesanan (username, phone, hotel, durasi, tanggalpesanan, tanggalakhir, tarif) VALUE (#{username}, #{phone}, #{hotel}, #{durasi}, #{tanggalpesan}, #{tanggalakhir}, #{tarif});
    </insert>

    <!-- Melakukan Update Tarif dan Tanggal ke DB Pesanan -->
    <update id="updatePesanan" parameterType="com.hotel.database.model.OrderHotel">
        UPDATE pesanan SET tanggalakhir=#{tanggalakhir} AND tarif=#{tarif} WHERE username=#{username);
    </update>

    <!-- Melakukan Update Database Hotel -->
    <update id="updateHotel" parameterType="com.hotel.database.model.Hotel">
        UPDATE listhotel SET terpakai=#{terpakai}, tersedia=#{tersedia} WHERE name=#{name};
    </update>

    <!-- Melakukan Update User DB untuk Status -->
    <update id="updateUserStatus" parameterType="com.hotel.database.model.User">
        UPDATE user SET status=#{status} WHERE username=#{username};
    </update>

</mapper>